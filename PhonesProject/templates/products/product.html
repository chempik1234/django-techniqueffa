{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="d-lg-inline-flex d-column my-5 py-2" xmlns="http://www.w3.org/1999/html">
    <div class="col flex-shrink-1">
        <div class="d-md-inline-flex d-block">
            <div class="product-image-gallery">
              <div class="image-zoom-container bg-light">
                  <img id="main-image" class="main-image" src="" alt="Main Product Image">
              </div>
              <div class="thumbnails">
              </div>
              <script src="{% static 'js/zoom.js' %}"></script>
              <script>
                  const mainImage = document.getElementById('main-image');
                  const thumbnailsContainer = document.querySelector('.thumbnails');
                  const productImages = {{ product_images|safe }};

                  function updateMainImage(imageUrl) {
                    mainImage.src = imageUrl;
                    mainImage.style.width = zoomContainer.clientWidth + 'px';
                  }

                  if (productImages.length > 0) {
                    updateMainImage(productImages[0].image);
                  }

                  productImages.forEach(image_element => {
                    const thumbnail = document.createElement('img');
                    thumbnail.src = image_element.image;
                    thumbnail.classList.add('thumbnail');
                    thumbnail.addEventListener('click', () => {
                      updateMainImage(image_element.image);
                    });
                    thumbnailsContainer.appendChild(thumbnail);
                  });
              </script>
            </div>
            <div class="d-column mx-2">
                <h4 class="text-uppercase font-weight-light">{{product.title}}</h4>
                <div class="">
                {% include 'products/price.html' with product=product %}
                <form action="/cart-add/" class="w-md-75" method="post">
                    <div class="input-group">
                        <input type="hidden" name="product_id" id="id_product_id" value="{{product.pk}}">
                        <input type="number" class="form-control" placeholder="" aria-label="" aria-describedby="basic-addon1" name="amount" id="id_amount" value="1">
                        <div class="input-group-append">
                            <input type="submit" class="btn btn-bg-purple" value="В корзину">
                        </div>
                    </div>
                </form>
                <p class="py-5">Категория: {{product.category}}</p>
            </div>
        </div>
        </div>
        <div>
            <ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">
              <li class="nav-item">
                <a class="nav-link active purple-nav-link" id="description-tab" data-toggle="tab" href="#description" role="tab" aria-controls="description" aria-selected="true">Описание</a>
              </li>
              <li class="nav-item">
                <a class="nav-link purple-nav-link" id="reviews-tab" data-toggle="tab" href="#reviews" role="tab" aria-controls="reviews" aria-selected="false">Отзывы</a>
              </li>
            </ul>
            <div class="tab-content" id="myTabContent">
              <div class="tab-pane fade show active" id="description" role="tabpanel" aria-labelledby="description-tab">
                  <h3 class="my-4">Описание</h3>
                  <p>{{product.description}}</p>
              </div>
              <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">...</div>
            </div>
        </div>
    </div>
    <div class="d-sm-column d-none flex-shrink-1 px-3 my-2">
        <h4 class="mb-3">Продукты</h4>
        <!--<form action="/search">
            <div class="input-group">
                <input type="text" class="form-control" placeholder="" aria-label="" aria-describedby="basic-addon1" name="q" id="id_q">
                <div class="input-group-append">
                    <input type="submit" class="btn btn-bg-purple" value="Найти">
                </div>
            </div>
        </form>
        <div class="mt-5">
            <h4>Корзина</h4>
            {% with
        </div>-->
    </div>
</div>
{% endblock %}